---
title: "Solution: Statistics, dimensionality reduction, and clustering"
author: "Author name goes here"
date: "2023-08-31"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

## Demo

### The standard normal distribution

#### pnorm()

The quantiles represent a set of possible values in the distribution.

```{r}
data_quantiles <- seq(-5, 5, 0.1)
head(data_quantiles)
```

The function `pnorm()` returns the probability of a observing a value less or equal to each quantile given.

```{r}
data_pnorm <- pnorm(q = data_quantiles) 
head(data_pnorm)
```

The base R `plot()` function can be used to quickly plot each quantile and its probability. 

```{r}
plot(data_quantiles, data_pnorm)
```

#### qnorm()

The function `qnorm()` takes as input a vector of probabilities between 0 and 1.

```{r}
data_probabilities <- seq(from = 0, to = 1, by = 0.02)
head(data_probabilities)
```

The function `qnorm()` the quantiles (i.e., values) that correspond to those probabilities.

```{r}
data_qnorm <- qnorm(p = data_probabilities) 
head(data_qnorm)
```

The base R `plot()` function can be used to quickly plot each quantile and its probability. 

```{r}
plot(data_probabilities, data_qnorm)
```

#### dnorm

The quantiles represent a set of possible values in the distribution.

```{r}
data_quantiles <- seq(-5, 5, 0.2)
head(data_quantiles)
```

The function `pnorm()` returns the probability of a observing a value less or equal to each quantile given.

```{r}
data_dnorm <- dnorm(x = data_quantiles) 
head(data_dnorm)
```

The base R `plot()` function can be used to quickly plot each quantile and its probability. 

```{r}
plot(data_quantiles, data_dnorm)
```

#### rnorm

```{r}
data_rnorm <- rnorm(n = 100)
head(data_rnorm)
```

```{r}
hist(data_rnorm, breaks = 20)
```

## Demo

### A parameterised normal distribution

#### pnorm()

The quantiles represent a set of possible values in the distribution.

```{r}
data_quantiles <- seq(-500, 500, 50)
head(data_quantiles)
```

The function `pnorm()` returns the probability of a observing a value less or equal to each quantile given.

```{r}
data_pnorm <- pnorm(q = data_quantiles, mean = 50, sd = 100)
head(data_pnorm)
```

The base R `plot()` function can be used to quickly plot each quantile and its probability. 

```{r}
plot(data_quantiles, data_pnorm)
```

#### qnorm()

The function `qnorm()` takes as input a vector of probabilities between 0 and 1.

```{r}
data_probabilities <- seq(from = 0, to = 1, by = 0.02)
head(data_probabilities)
```

The function `qnorm()` the quantiles (i.e., values) that correspond to those probabilities.

```{r}
data_qnorm <- qnorm(p = data_probabilities, mean = 50, sd = 100) 
head(data_qnorm)
```

The base R `plot()` function can be used to quickly plot each quantile and its probability. 

```{r}
plot(data_probabilities, data_qnorm)
```

#### dnorm

The quantiles represent a set of possible values in the distribution.

```{r}
data_quantiles <- seq(-500, 500, 50)
head(data_quantiles)
```

The function `pnorm()` returns the probability of a observing a value less or equal to each quantile given.

```{r}
data_dnorm <- dnorm(x = data_quantiles, mean = 50, sd = 100) 
head(data_dnorm)
```

The base R `plot()` function can be used to quickly plot each quantile and its probability. 

```{r}
plot(data_quantiles, data_dnorm)
```

#### rnorm

```{r}
data_rnorm <- rnorm(n = 100, mean = 50, sd = 100)
head(data_rnorm)
```

```{r}
hist(data_rnorm, breaks = 20)
```

## Demo

### A parameterised binomial distribution

#### pnorm()

The quantiles represent a set of possible values in the distribution.

```{r}
data_quantiles <- seq(0, 50, 1)
head(data_quantiles)
```

The function `pnorm()` returns the probability of a observing a value less or equal to each quantile given.

```{r}
data_pbinom <- pbinom(q = data_quantiles, size = 50, prob = 0.1)
head(data_pbinom)
```

The base R `plot()` function can be used to quickly plot each quantile and its probability. 

```{r}
plot(data_quantiles, data_pbinom)
```

#### qbinom()

The function `qbinom()` takes as input a vector of probabilities between 0 and 1.

```{r}
data_probabilities <- seq(from = 0, to = 1, by = 0.02)
head(data_probabilities)
```

The function `qbinom()` the quantiles (i.e., values) that correspond to those probabilities.

```{r}
data_qbinom <- qbinom(p = data_probabilities, size = 50, prob = 0.1)
head(data_qbinom)
```

The base R `plot()` function can be used to quickly plot each quantile and its probability. 

```{r}
plot(data_probabilities, data_qbinom)
```

#### dbinom

The quantiles represent a set of possible values in the distribution.

```{r}
data_quantiles <- seq(0, 50, 1)
head(data_quantiles)
```

The function `pbinom()` returns the probability of a observing a value less or equal to each quantile given.

```{r}
data_dbinom <- dbinom(x = data_quantiles, size = 50, prob = 0.1)
head(data_dbinom)
```

The base R `plot()` function can be used to quickly plot each quantile and its probability. 

```{r}
plot(data_quantiles, data_dbinom)
```

#### rbinom

```{r}
data_rbinom <- rbinom(n = 100, size = 50, prob = 0.1)
head(data_rbinom)
```

```{r}
hist(data_rbinom, breaks = 20)
```

## Demo

### Quantiles

```{r}
data_rnorm <- rnorm(n = 1000, mean = 50, sd = 100)
quantile(data_rnorm, probs = seq(0, 1, 0.1))
```

```{r}
plot(
  seq(0, 1, 0.1),
  quantile(data_rnorm, probs = seq(0, 1, 0.1))
)
```

## Demo

### Parametric t-test

```{r}
set.seed(1)
x <- rnorm(n = 1000, mean = 0, sd = 1)
y <- rnorm(n = 2000, mean = 1, sd = 1)
```

In base R, `par(mfrow=c(i, j)))` can be used to display plots in a grid of `i` rows and `j` columns.

```{r, fig.height=7}
par(mfrow = c(2, 1))
hist(x, breaks = 30)
hist(y, breaks = 30)
par(mfrow = c(1, 1 ))
```


```{r}
t.test(x, y)
```

```{r}
t.test(y, x)
```

## Demo

### Paired test

Simulate a vector of values `x`.
Then simulate values `y` that are systematically 2 units greater than their `x` counterpart,
with a bit of noise (normally distributed).

```{r}
set.seed(1)
n_sample <- 10
x <- runif(n = n_sample, min = 10, max = 20)
y <- x + 2 + rnorm(n = n_sample, mean = 0, sd = 1)
```

The average difference between `y` and `x` values is approximately 2, as intended. 

```{r}
mean(y - x)
```

```{r}
t.test(x, y, paired = TRUE)
```
